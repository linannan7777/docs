<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.14" />
    <style>
      :root {
        --c-bg: #fff;
      }

      html.dark {
        --c-bg: #22272e;
      }

      html,
      body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia('(prefers-color-scheme: dark)').matches
      if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
        document.documentElement.classList.toggle('dark', true)
      }
    </script>
    <title>技术文档</title><meta name="description" content="温故而知新">
    <link rel="preload" href="/assets/style-BDZmSSuf.css" as="style"><link rel="stylesheet" href="/assets/style-BDZmSSuf.css">
    <link rel="modulepreload" href="/assets/app-DCPYa7PH.js"><link rel="modulepreload" href="/assets/第25课：用Python读写Excel文件-2.html-B5wmXfmW.js">
    <link rel="prefetch" href="/assets/index.html-Bd34-iPE.js" as="script"><link rel="prefetch" href="/assets/index.html-DlwPAw1O.js" as="script"><link rel="prefetch" href="/assets/第01课：初识Python.html-DCZx7nn_.js" as="script"><link rel="prefetch" href="/assets/第02课：第一个Python程序.html-DbbnozI2.js" as="script"><link rel="prefetch" href="/assets/第03课：Python语言元素之变量.html-CMuvsUP0.js" as="script"><link rel="prefetch" href="/assets/第04课：Python语言元素之运算符.html-KVvkaGoZ.js" as="script"><link rel="prefetch" href="/assets/第05课：分支结构.html-D9I8TxTs.js" as="script"><link rel="prefetch" href="/assets/第06课：循环结构.html-BPnFgwD0.js" as="script"><link rel="prefetch" href="/assets/第07课：分支和循环结构的应用.html-BL2wvrcy.js" as="script"><link rel="prefetch" href="/assets/第08课：常用数据结构之列表.html-BpbmbytL.js" as="script"><link rel="prefetch" href="/assets/第09课：常用数据结构之元组.html-BHvk2oUC.js" as="script"><link rel="prefetch" href="/assets/第10课：常用数据结构之字符串.html-CkJs9oYU.js" as="script"><link rel="prefetch" href="/assets/第11课：常用数据结构之集合.html-B9eBsRWC.js" as="script"><link rel="prefetch" href="/assets/第12课：常用数据结构之字典.html-B_7KQVLQ.js" as="script"><link rel="prefetch" href="/assets/第13课：函数和模块.html-DtuL7Nkq.js" as="script"><link rel="prefetch" href="/assets/第14课：函数的应用.html-emfOCGBg.js" as="script"><link rel="prefetch" href="/assets/第15课：函数使用进阶.html-CWP_lbRI.js" as="script"><link rel="prefetch" href="/assets/第16课：函数的高级应用.html-Cxoy5cJM.js" as="script"><link rel="prefetch" href="/assets/第17课：面向对象编程入门.html-Dcp_cQcW.js" as="script"><link rel="prefetch" href="/assets/第18课：面向对象编程进阶.html-DUgRdWPS.js" as="script"><link rel="prefetch" href="/assets/第19课：面向对象编程应用.html-CKz5EZ7f.js" as="script"><link rel="prefetch" href="/assets/第20课：Python标准库初探.html-CRFTF3P1.js" as="script"><link rel="prefetch" href="/assets/第21课：文件读写和异常处理.html-Vf0ePXrk.js" as="script"><link rel="prefetch" href="/assets/第22课：对象的序列化和反序列化.html-Cv62HjfW.js" as="script"><link rel="prefetch" href="/assets/第23课：用Python读写CSV文件.html-C3vq3BpA.js" as="script"><link rel="prefetch" href="/assets/第24课：用Python读写Excel文件-1.html-sXdMXx-K.js" as="script"><link rel="prefetch" href="/assets/第26课：用Python操作Word文件和PowerPoint.html-Crn4uJaa.js" as="script"><link rel="prefetch" href="/assets/第27课：用Python操作PDF文件.html-DPstOvxR.js" as="script"><link rel="prefetch" href="/assets/第28课：用Python处理图像.html-BkpCHlYI.js" as="script"><link rel="prefetch" href="/assets/第29课：用Python发送邮件和短信.html-mQx5b7MG.js" as="script"><link rel="prefetch" href="/assets/第30课：正则表达式的应用.html-Chgc_MW5.js" as="script"><link rel="prefetch" href="/assets/第31课：网络数据采集概述.html-DA6aiwpb.js" as="script"><link rel="prefetch" href="/assets/第32课：用Python获取网络资源.html-BjPwPreN.js" as="script"><link rel="prefetch" href="/assets/第33课：用Python解析HTML页面.html-BkPmQqCp.js" as="script"><link rel="prefetch" href="/assets/第34课：Python中的并发编程-1.html-CHUXsH59.js" as="script"><link rel="prefetch" href="/assets/第35课：Python中的并发编程-2.html-CLoBxV19.js" as="script"><link rel="prefetch" href="/assets/第36课：Python中的并发编程-3.html-CvuNbBHb.js" as="script"><link rel="prefetch" href="/assets/第37课：并发编程在爬虫中的应用.html-Bgk7bh2v.js" as="script"><link rel="prefetch" href="/assets/第38课：抓取网页动态内容.html-DTzPW4iI.js" as="script"><link rel="prefetch" href="/assets/第39课：爬虫框架Scrapy简介.html-CFnhzLzF.js" as="script"><link rel="prefetch" href="/assets/第40课：关系型数据库和MySQL概述.html-Cw0dAvqK.js" as="script"><link rel="prefetch" href="/assets/第41课.SQL详解之DDL.html-EGwd0y_w.js" as="script"><link rel="prefetch" href="/assets/第42课.SQL详解之DML.html-C3LjZyjy.js" as="script"><link rel="prefetch" href="/assets/第43课.SQL详解之DQL.html-Gw2b-v-f.js" as="script"><link rel="prefetch" href="/assets/第44课.SQL详解之DCL.html-hJ_xjXpc.js" as="script"><link rel="prefetch" href="/assets/第45课.索引.html-DwAl_f1c.js" as="script"><link rel="prefetch" href="/assets/第46课.视图_函数_过程.html-DoR0jE_b.js" as="script"><link rel="prefetch" href="/assets/第47课.MySQL新特性.html-DS9CN1jy.js" as="script"><link rel="prefetch" href="/assets/第48课.Python程序接入MySQL数据库.html-C-hQ1EDh.js" as="script"><link rel="prefetch" href="/assets/404.html-CmMHWV14.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon"><!--[--><header class="vp-navbar"><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><img class="vp-site-logo" src="https://vuejs.press/images/hero.png" alt="技术文档"><span class="vp-site-name vp-hide-mobile" aria-hidden="true">技术文档</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="python"><span class="title">python</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="python"><span class="title">python</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><!--[--><h4 class="vp-navbar-dropdown-subtitle"><span>50天基础</span></h4><ul class="vp-navbar-dropdown-subitem-wrapper"><!--[--><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/python/Python-Core-50-Courses/%E7%AC%AC01%E8%AF%BE%EF%BC%9A%E5%88%9D%E8%AF%86Python.html" aria-label="第01课：初识Python"><!---->第01课：初识Python<!----></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="参考"><span class="title">参考</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="参考"><span class="title">参考</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><!--[--><h4 class="vp-navbar-dropdown-subtitle"><span>核心</span></h4><ul class="vp-navbar-dropdown-subitem-wrapper"><!--[--><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/zh/reference/cli.html" aria-label="/zh/reference/cli.html"><!---->/zh/reference/cli.html<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/zh/reference/config.html" aria-label="/zh/reference/config.html"><!---->/zh/reference/config.html<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/zh/reference/frontmatter.html" aria-label="/zh/reference/frontmatter.html"><!---->/zh/reference/frontmatter.html<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/zh/reference/components.html" aria-label="/zh/reference/components.html"><!---->/zh/reference/components.html<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/zh/reference/plugin-api.html" aria-label="/zh/reference/plugin-api.html"><!---->/zh/reference/plugin-api.html<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/zh/reference/theme-api.html" aria-label="/zh/reference/theme-api.html"><!---->/zh/reference/theme-api.html<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/zh/reference/client-api.html" aria-label="/zh/reference/client-api.html"><!---->/zh/reference/client-api.html<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/zh/reference/node-api.html" aria-label="/zh/reference/node-api.html"><!---->/zh/reference/node-api.html<!----></a></li><!--]--></ul><!--]--></li><li class="vp-navbar-dropdown-item"><!--[--><h4 class="vp-navbar-dropdown-subtitle"><span>打包工具</span></h4><ul class="vp-navbar-dropdown-subitem-wrapper"><!--[--><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/zh/reference/bundler/vite.html" aria-label="/zh/reference/bundler/vite.html"><!---->/zh/reference/bundler/vite.html<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/zh/reference/bundler/webpack.html" aria-label="/zh/reference/bundler/webpack.html"><!---->/zh/reference/bundler/webpack.html<!----></a></li><!--]--></ul><!--]--></li><li class="vp-navbar-dropdown-item"><!--[--><h4 class="vp-navbar-dropdown-subtitle"><span>生态系统</span></h4><ul class="vp-navbar-dropdown-subitem-wrapper"><!--[--><li class="vp-navbar-dropdown-subitem"><a class="auto-link external-link" href="https://ecosystem.vuejs.press/zh/themes/default/" aria-label="默认主题" rel="noopener noreferrer" target="_blank"><!---->默认主题<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="auto-link external-link" href="https://ecosystem.vuejs.press/zh/plugins/" aria-label="插件" rel="noopener noreferrer" target="_blank"><!---->插件<!----></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="了解更多"><span class="title">了解更多</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="了解更多"><span class="title">了解更多</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><!--[--><h4 class="vp-navbar-dropdown-subtitle"><span>深入</span></h4><ul class="vp-navbar-dropdown-subitem-wrapper"><!--[--><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/zh/advanced/architecture.html" aria-label="/zh/advanced/architecture.html"><!---->/zh/advanced/architecture.html<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/zh/advanced/plugin.html" aria-label="/zh/advanced/plugin.html"><!---->/zh/advanced/plugin.html<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/zh/advanced/theme.html" aria-label="/zh/advanced/theme.html"><!---->/zh/advanced/theme.html<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/zh/advanced/cookbook/" aria-label="Cookbook"><!---->Cookbook<!----></a></li><!--]--></ul><!--]--></li><li class="vp-navbar-dropdown-item"><!--[--><h4 class="vp-navbar-dropdown-subtitle"><span>其他资源</span></h4><ul class="vp-navbar-dropdown-subitem-wrapper"><!--[--><li class="vp-navbar-dropdown-subitem"><a class="auto-link external-link" href="https://ecosystem.vuejs.press/zh/" aria-label="生态系统" rel="noopener noreferrer" target="_blank"><!---->生态系统<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="auto-link external-link" href="https://marketplace.vuejs.press/zh/" aria-label="市场" rel="noopener noreferrer" target="_blank"><!---->市场<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="auto-link external-link" href="https://github.com/vuepress/core/blob/main/CONTRIBUTING_zh.md" aria-label="贡献指南" rel="noopener noreferrer" target="_blank"><!---->贡献指南<!----></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><button class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar"><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="python"><span class="title">python</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="python"><span class="title">python</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><!--[--><h4 class="vp-navbar-dropdown-subtitle"><span>50天基础</span></h4><ul class="vp-navbar-dropdown-subitem-wrapper"><!--[--><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/python/Python-Core-50-Courses/%E7%AC%AC01%E8%AF%BE%EF%BC%9A%E5%88%9D%E8%AF%86Python.html" aria-label="第01课：初识Python"><!---->第01课：初识Python<!----></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="参考"><span class="title">参考</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="参考"><span class="title">参考</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><!--[--><h4 class="vp-navbar-dropdown-subtitle"><span>核心</span></h4><ul class="vp-navbar-dropdown-subitem-wrapper"><!--[--><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/zh/reference/cli.html" aria-label="/zh/reference/cli.html"><!---->/zh/reference/cli.html<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/zh/reference/config.html" aria-label="/zh/reference/config.html"><!---->/zh/reference/config.html<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/zh/reference/frontmatter.html" aria-label="/zh/reference/frontmatter.html"><!---->/zh/reference/frontmatter.html<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/zh/reference/components.html" aria-label="/zh/reference/components.html"><!---->/zh/reference/components.html<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/zh/reference/plugin-api.html" aria-label="/zh/reference/plugin-api.html"><!---->/zh/reference/plugin-api.html<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/zh/reference/theme-api.html" aria-label="/zh/reference/theme-api.html"><!---->/zh/reference/theme-api.html<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/zh/reference/client-api.html" aria-label="/zh/reference/client-api.html"><!---->/zh/reference/client-api.html<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/zh/reference/node-api.html" aria-label="/zh/reference/node-api.html"><!---->/zh/reference/node-api.html<!----></a></li><!--]--></ul><!--]--></li><li class="vp-navbar-dropdown-item"><!--[--><h4 class="vp-navbar-dropdown-subtitle"><span>打包工具</span></h4><ul class="vp-navbar-dropdown-subitem-wrapper"><!--[--><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/zh/reference/bundler/vite.html" aria-label="/zh/reference/bundler/vite.html"><!---->/zh/reference/bundler/vite.html<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/zh/reference/bundler/webpack.html" aria-label="/zh/reference/bundler/webpack.html"><!---->/zh/reference/bundler/webpack.html<!----></a></li><!--]--></ul><!--]--></li><li class="vp-navbar-dropdown-item"><!--[--><h4 class="vp-navbar-dropdown-subtitle"><span>生态系统</span></h4><ul class="vp-navbar-dropdown-subitem-wrapper"><!--[--><li class="vp-navbar-dropdown-subitem"><a class="auto-link external-link" href="https://ecosystem.vuejs.press/zh/themes/default/" aria-label="默认主题" rel="noopener noreferrer" target="_blank"><!---->默认主题<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="auto-link external-link" href="https://ecosystem.vuejs.press/zh/plugins/" aria-label="插件" rel="noopener noreferrer" target="_blank"><!---->插件<!----></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="了解更多"><span class="title">了解更多</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="了解更多"><span class="title">了解更多</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><!--[--><h4 class="vp-navbar-dropdown-subtitle"><span>深入</span></h4><ul class="vp-navbar-dropdown-subitem-wrapper"><!--[--><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/zh/advanced/architecture.html" aria-label="/zh/advanced/architecture.html"><!---->/zh/advanced/architecture.html<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/zh/advanced/plugin.html" aria-label="/zh/advanced/plugin.html"><!---->/zh/advanced/plugin.html<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/zh/advanced/theme.html" aria-label="/zh/advanced/theme.html"><!---->/zh/advanced/theme.html<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/zh/advanced/cookbook/" aria-label="Cookbook"><!---->Cookbook<!----></a></li><!--]--></ul><!--]--></li><li class="vp-navbar-dropdown-item"><!--[--><h4 class="vp-navbar-dropdown-subtitle"><span>其他资源</span></h4><ul class="vp-navbar-dropdown-subitem-wrapper"><!--[--><li class="vp-navbar-dropdown-subitem"><a class="auto-link external-link" href="https://ecosystem.vuejs.press/zh/" aria-label="生态系统" rel="noopener noreferrer" target="_blank"><!---->生态系统<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="auto-link external-link" href="https://marketplace.vuejs.press/zh/" aria-label="市场" rel="noopener noreferrer" target="_blank"><!---->市场<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="auto-link external-link" href="https://github.com/vuepress/core/blob/main/CONTRIBUTING_zh.md" aria-label="贡献指南" rel="noopener noreferrer" target="_blank"><!---->贡献指南<!----></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">指南 <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/python/Python-Core-50-Courses/introduction.html" aria-label="/python/Python-Core-50-Courses/introduction.html"><!---->/python/Python-Core-50-Courses/introduction.html<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/python/Python-Core-50-Courses/getting-started.html" aria-label="/python/Python-Core-50-Courses/getting-started.html"><!---->/python/Python-Core-50-Courses/getting-started.html<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/python/Python-Core-50-Courses/configuration.html" aria-label="/python/Python-Core-50-Courses/configuration.html"><!---->/python/Python-Core-50-Courses/configuration.html<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/python/Python-Core-50-Courses/page.html" aria-label="/python/Python-Core-50-Courses/page.html"><!---->/python/Python-Core-50-Courses/page.html<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/python/Python-Core-50-Courses/markdown.html" aria-label="/python/Python-Core-50-Courses/markdown.html"><!---->/python/Python-Core-50-Courses/markdown.html<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/python/Python-Core-50-Courses/assets.html" aria-label="/python/Python-Core-50-Courses/assets.html"><!---->/python/Python-Core-50-Courses/assets.html<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/python/Python-Core-50-Courses/i18n.html" aria-label="/python/Python-Core-50-Courses/i18n.html"><!---->/python/Python-Core-50-Courses/i18n.html<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/python/Python-Core-50-Courses/deployment.html" aria-label="/python/Python-Core-50-Courses/deployment.html"><!---->/python/Python-Core-50-Courses/deployment.html<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/python/Python-Core-50-Courses/theme.html" aria-label="/python/Python-Core-50-Courses/theme.html"><!---->/python/Python-Core-50-Courses/theme.html<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/python/Python-Core-50-Courses/plugin.html" aria-label="/python/Python-Core-50-Courses/plugin.html"><!---->/python/Python-Core-50-Courses/plugin.html<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/python/Python-Core-50-Courses/bundler.html" aria-label="/python/Python-Core-50-Courses/bundler.html"><!---->/python/Python-Core-50-Courses/bundler.html<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/python/Python-Core-50-Courses/migration.html" aria-label="/python/Python-Core-50-Courses/migration.html"><!---->/python/Python-Core-50-Courses/migration.html<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/python/Python-Core-50-Courses/troubleshooting.html" aria-label="/python/Python-Core-50-Courses/troubleshooting.html"><!---->/python/Python-Core-50-Courses/troubleshooting.html<!----></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h2 id="第25课-用python读写excel文件-2" tabindex="-1"><a class="header-anchor" href="#第25课-用python读写excel文件-2"><span>第25课：用Python读写Excel文件-2</span></a></h2><h3 id="excel简介" tabindex="-1"><a class="header-anchor" href="#excel简介"><span>Excel简介</span></a></h3><p>Excel是Microsoft（微软）为使用Windows和macOS操作系统开发的一款电子表格软件。Excel凭借其直观的界面、出色的计算功能和图表工具，再加上成功的市场营销，一直以来都是最为流行的个人计算机数据处理软件。当然，Excel也有很多竞品，例如Google Sheets、LibreOffice Calc、Numbers等，这些竞品基本上也能够兼容Excel，至少能够读写较新版本的Excel文件，当然这些不是我们讨论的重点。掌握用Python程序操作Excel文件，可以让日常办公自动化的工作更加轻松愉快，而且在很多商业项目中，导入导出Excel文件都是特别常见的功能。</p><p>本章我们继续讲解基于另一个三方库<code>openpyxl</code>如何进行Excel文件操作，首先需要先安装它。</p><div class="language-Bash line-numbers-mode" data-highlighter="prismjs" data-ext="Bash" data-title="Bash"><pre class="language-Bash"><code><span class="line">pip install openpyxl</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><code>openpyxl</code>的优点在于，当我们打开一个Excel文件后，既可以对它进行读操作，又可以对它进行写操作，而且在操作的便捷性上是优于<code>xlwt</code>和<code>xlrd</code>的。此外，如果要进行样式编辑和公式计算，使用<code>openpyxl</code>也远比上一个章节我们讲解的方式更为简单，而且<code>openpyxl</code>还支持数据透视和插入图表等操作，功能非常强大。有一点需要再次强调，<code>openpyxl</code>并不支持操作Office 2007以前版本的Excel文件。</p><h3 id="读取excel文件" tabindex="-1"><a class="header-anchor" href="#读取excel文件"><span>读取Excel文件</span></a></h3><p>例如在当前文件夹下有一个名为“阿里巴巴2020年股票数据.xlsx”的Excel文件，如果想读取并显示该文件的内容，可以通过如下所示的代码来完成。</p><div class="language-Python line-numbers-mode" data-highlighter="prismjs" data-ext="Python" data-title="Python"><pre class="language-Python"><code><span class="line">import datetime</span>
<span class="line"></span>
<span class="line">import openpyxl</span>
<span class="line"></span>
<span class="line"># 加载一个工作簿 ---&gt; Workbook</span>
<span class="line">wb = openpyxl.load_workbook(&#39;阿里巴巴2020年股票数据.xlsx&#39;)</span>
<span class="line"># 获取工作表的名字</span>
<span class="line">print(wb.sheetnames)</span>
<span class="line"># 获取工作表 ---&gt; Worksheet</span>
<span class="line">sheet = wb.worksheets[0]</span>
<span class="line"># 获得单元格的范围</span>
<span class="line">print(sheet.dimensions)</span>
<span class="line"># 获得行数和列数</span>
<span class="line">print(sheet.max_row, sheet.max_column)</span>
<span class="line"></span>
<span class="line"># 获取指定单元格的值</span>
<span class="line">print(sheet.cell(3, 3).value)</span>
<span class="line">print(sheet[&#39;C3&#39;].value)</span>
<span class="line">print(sheet[&#39;G255&#39;].value)</span>
<span class="line"></span>
<span class="line"># 获取多个单元格（嵌套元组）</span>
<span class="line">print(sheet[&#39;A2:C5&#39;])</span>
<span class="line"></span>
<span class="line"># 读取所有单元格的数据</span>
<span class="line">for row_ch in range(2, sheet.max_row + 1):</span>
<span class="line">    for col_ch in &#39;ABCDEFG&#39;:</span>
<span class="line">        value = sheet[f&#39;{col_ch}{row_ch}&#39;].value</span>
<span class="line">        if type(value) == datetime.datetime:</span>
<span class="line">            print(value.strftime(&#39;%Y年%m月%d日&#39;), end=&#39;\t&#39;)</span>
<span class="line">        elif type(value) == int:</span>
<span class="line">            print(f&#39;{value:&lt;10d}&#39;, end=&#39;\t&#39;)</span>
<span class="line">        elif type(value) == float:</span>
<span class="line">            print(f&#39;{value:.4f}&#39;, end=&#39;\t&#39;)</span>
<span class="line">        else:</span>
<span class="line">            print(value, end=&#39;\t&#39;)</span>
<span class="line">    print()</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>提示</strong>：上面代码中使用的Excel文件“阿里巴巴2020年股票数据.xlsx”可以通过后面的百度云盘地址进行获取。链接:https://pan.baidu.com/s/1rQujl5RQn9R7PadB2Z5g_g 提取码:e7b4。</p></blockquote><p>需要提醒大家一点，<code>openpyxl</code>获取指定的单元格有两种方式，一种是通过<code>cell</code>方法，需要注意，该方法的行索引和列索引都是从<code>1</code>开始的，这是为了照顾用惯了Excel的人的习惯；另一种是通过索引运算，通过指定单元格的坐标，例如<code>C3</code>、<code>G255</code>，也可以取得对应的单元格，再通过单元格对象的<code>value</code>属性，就可以获取到单元格的值。通过上面的代码，相信大家还注意到了，可以通过类似<code>sheet[&#39;A2:C5&#39;]</code>或<code>sheet[&#39;A2&#39;:&#39;C5&#39;]</code>这样的切片操作获取多个单元格，该操作将返回嵌套的元组，相当于获取到了多行多列。</p><h3 id="写excel文件" tabindex="-1"><a class="header-anchor" href="#写excel文件"><span>写Excel文件</span></a></h3><p>下面我们使用<code>openpyxl</code>来进行写Excel操作。</p><div class="language-Python line-numbers-mode" data-highlighter="prismjs" data-ext="Python" data-title="Python"><pre class="language-Python"><code><span class="line">import random</span>
<span class="line"></span>
<span class="line">import openpyxl</span>
<span class="line"></span>
<span class="line"># 第一步：创建工作簿（Workbook）</span>
<span class="line">wb = openpyxl.Workbook()</span>
<span class="line"></span>
<span class="line"># 第二步：添加工作表（Worksheet）</span>
<span class="line">sheet = wb.active</span>
<span class="line">sheet.title = &#39;期末成绩&#39;</span>
<span class="line"></span>
<span class="line">titles = (&#39;姓名&#39;, &#39;语文&#39;, &#39;数学&#39;, &#39;英语&#39;)</span>
<span class="line">for col_index, title in enumerate(titles):</span>
<span class="line">    sheet.cell(1, col_index + 1, title)</span>
<span class="line"></span>
<span class="line">names = (&#39;关羽&#39;, &#39;张飞&#39;, &#39;赵云&#39;, &#39;马超&#39;, &#39;黄忠&#39;)</span>
<span class="line">for row_index, name in enumerate(names):</span>
<span class="line">    sheet.cell(row_index + 2, 1, name)</span>
<span class="line">    for col_index in range(2, 5):</span>
<span class="line">        sheet.cell(row_index + 2, col_index, random.randrange(50, 101))</span>
<span class="line"></span>
<span class="line"># 第四步：保存工作簿</span>
<span class="line">wb.save(&#39;考试成绩表.xlsx&#39;)</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="调整样式和公式计算" tabindex="-1"><a class="header-anchor" href="#调整样式和公式计算"><span>调整样式和公式计算</span></a></h4><p>在使用<code>openpyxl</code>操作Excel时，如果要调整单元格的样式，可以直接通过单元格对象（<code>Cell</code>对象）的属性进行操作。单元格对象的属性包括字体（<code>font</code>）、对齐（<code>alignment</code>）、边框（<code>border</code>）等，具体的可以参考<code>openpyxl</code>的<a href="https://openpyxl.readthedocs.io/en/stable/index.html" target="_blank" rel="noopener noreferrer">官方文档</a>。在使用<code>openpyxl</code>时，如果需要做公式计算，可以完全按照Excel中的操作方式来进行，具体的代码如下所示。</p><div class="language-Python line-numbers-mode" data-highlighter="prismjs" data-ext="Python" data-title="Python"><pre class="language-Python"><code><span class="line">import openpyxl</span>
<span class="line">from openpyxl.styles import Font, Alignment, Border, Side</span>
<span class="line"></span>
<span class="line"># 对齐方式</span>
<span class="line">alignment = Alignment(horizontal=&#39;center&#39;, vertical=&#39;center&#39;)</span>
<span class="line"># 边框线条</span>
<span class="line">side = Side(color=&#39;ff7f50&#39;, style=&#39;mediumDashed&#39;)</span>
<span class="line"></span>
<span class="line">wb = openpyxl.load_workbook(&#39;考试成绩表.xlsx&#39;)</span>
<span class="line">sheet = wb.worksheets[0]</span>
<span class="line"></span>
<span class="line"># 调整行高和列宽</span>
<span class="line">sheet.row_dimensions[1].height = 30</span>
<span class="line">sheet.column_dimensions[&#39;E&#39;].width = 120</span>
<span class="line"></span>
<span class="line">sheet[&#39;E1&#39;] = &#39;平均分&#39;</span>
<span class="line"># 设置字体</span>
<span class="line">sheet.cell(1, 5).font = Font(size=18, bold=True, color=&#39;ff1493&#39;, name=&#39;华文楷体&#39;)</span>
<span class="line"># 设置对齐方式</span>
<span class="line">sheet.cell(1, 5).alignment = alignment</span>
<span class="line"># 设置单元格边框</span>
<span class="line">sheet.cell(1, 5).border = Border(left=side, top=side, right=side, bottom=side)</span>
<span class="line">for i in range(2, 7):</span>
<span class="line">    # 公式计算每个学生的平均分</span>
<span class="line">    sheet[f&#39;E{i}&#39;] = f&#39;=average(B{i}:D{i})&#39;</span>
<span class="line">    sheet.cell(i, 5).font = Font(size=12, color=&#39;4169e1&#39;, italic=True)</span>
<span class="line">    sheet.cell(i, 5).alignment = alignment</span>
<span class="line"></span>
<span class="line">wb.save(&#39;考试成绩表.xlsx&#39;)</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="生成统计图表" tabindex="-1"><a class="header-anchor" href="#生成统计图表"><span>生成统计图表</span></a></h3><p>通过<code>openpyxl</code>库，可以直接向Excel中插入统计图表，具体的做法跟在Excel中插入图表大体一致。我们可以创建指定类型的图表对象，然后通过该对象的属性对图表进行设置。当然，最为重要的是为图表绑定数据，即横轴代表什么，纵轴代表什么，具体的数值是多少。最后，可以将图表对象添加到表单中，具体的代码如下所示。</p><div class="language-Python line-numbers-mode" data-highlighter="prismjs" data-ext="Python" data-title="Python"><pre class="language-Python"><code><span class="line">from openpyxl import Workbook</span>
<span class="line">from openpyxl.chart import BarChart, Reference</span>
<span class="line"></span>
<span class="line">wb = Workbook(write_only=True)</span>
<span class="line">sheet = wb.create_sheet()</span>
<span class="line"></span>
<span class="line">rows = [</span>
<span class="line">    (&#39;类别&#39;, &#39;销售A组&#39;, &#39;销售B组&#39;),</span>
<span class="line">    (&#39;手机&#39;, 40, 30),</span>
<span class="line">    (&#39;平板&#39;, 50, 60),</span>
<span class="line">    (&#39;笔记本&#39;, 80, 70),</span>
<span class="line">    (&#39;外围设备&#39;, 20, 10),</span>
<span class="line">]</span>
<span class="line"></span>
<span class="line"># 向表单中添加行</span>
<span class="line">for row in rows:</span>
<span class="line">    sheet.append(row)</span>
<span class="line"></span>
<span class="line"># 创建图表对象</span>
<span class="line">chart = BarChart()</span>
<span class="line">chart.type = &#39;col&#39;</span>
<span class="line">chart.style = 10</span>
<span class="line"># 设置图表的标题</span>
<span class="line">chart.title = &#39;销售统计图&#39;</span>
<span class="line"># 设置图表纵轴的标题</span>
<span class="line">chart.y_axis.title = &#39;销量&#39;</span>
<span class="line"># 设置图表横轴的标题</span>
<span class="line">chart.x_axis.title = &#39;商品类别&#39;</span>
<span class="line"># 设置数据的范围</span>
<span class="line">data = Reference(sheet, min_col=2, min_row=1, max_row=5, max_col=3)</span>
<span class="line"># 设置分类的范围</span>
<span class="line">cats = Reference(sheet, min_col=1, min_row=2, max_row=5)</span>
<span class="line"># 给图表添加数据</span>
<span class="line">chart.add_data(data, titles_from_data=True)</span>
<span class="line"># 给图表设置分类</span>
<span class="line">chart.set_categories(cats)</span>
<span class="line">chart.shape = 4</span>
<span class="line"># 将图表添加到表单指定的单元格中</span>
<span class="line">sheet.add_chart(chart, &#39;A10&#39;)</span>
<span class="line"></span>
<span class="line">wb.save(&#39;demo.xlsx&#39;)</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行上面的代码，打开生成的Excel文件，效果如下图所示。</p><img src="https://github.com/jackfrued/mypic/raw/master/20210819235009.png" alt="image-20210819235009026" width="75%"><h3 id="简单的总结" tabindex="-1"><a class="header-anchor" href="#简单的总结"><span>简单的总结</span></a></h3><p>掌握了Python程序操作Excel的方法，可以解决日常办公中很多繁琐的处理Excel电子表格工作，最常见就是将多个数据格式相同的Excel文件合并到一个文件以及从多个Excel文件或表单中提取指定的数据。如果数据体量较大或者处理数据的方式比较复杂，我们还是推荐大家使用Python数据分析神器之一的<code>pandas</code>库。</p></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: linannan@prosnav.com">linannan</span><!----><!--]--><!--]--></span></div></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-DCPYa7PH.js" defer></script>
  </body>
</html>
